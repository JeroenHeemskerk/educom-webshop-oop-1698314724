<?php

require_once('page_model.php');

class UserModel extends PageModel
{
    public $name = ""; // of $values = array();
    public $email = ""; //or $meta = array();
    public $password = "";
    public $repeatedPassword = "";
    public $phonenumber = "";
    public $comm_preference = "";
    public $message = "";
    public $namerErr = "";
    public $emailErr = "";
    public $passwordErr = "";
    public $phonenumberErr = "";
    public $comm_preferenceErr = "";
    public $messageErr = "";

    private $userId = 0;
    public $valid = false;


    public function __construct($pageModel)
    {
        PARENT::__construct($pageModel);
        //volgens mij roep ik hier de constructor van pagemodel (parent) aan. 
        // de input geef ik mee als ik een nieuwe instantie maak van usermodel. 
    }

    public function validateLogin()
    {
        require_once('validations.php');
        $validations = new Validators();
        // .. hier moet de juiste functie in
        //logindata?

        $loginData = $validations->collectAndValidateEmail($loginData, "email", "Email");
        $loginData = $validations->collectRequiredField($loginData, 'password', "Password");

        $this->valid = empty($this->emailErr) && empty($this->passwordErr);

        if ($this->valid == true) {
            $loginData = validateLoginAttempt($loginData);
        }

        if ($this->valid == true) {
            $this->page = 'home';
        }

        return $loginData;

        //dit komt uit de opdracht, niet mijn eigen code
        $this->valid = true;
    }

    private function authenticateUser()
    {
        require_once('../database-connection.php');
        $user = findUserByEmail($this->email);

        // .. password validatie

        $this->name = $user['name'];
        $tis->userId = $user['id'];
    }

    public function doLoginUser()
    {
        $this->sessionManager->doLoginUser($this->name, $this->userId);
        //$this->genericMessage = "Login succesvol";
        $this->errors['genericError'] = "Login succesvol";
        // die onderste werkt bij mij

    }
}
